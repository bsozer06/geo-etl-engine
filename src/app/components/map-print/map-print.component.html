<div class="relative group" (clickOutside)="showMenu.set(false)">
    <button (click)="toggleMenu()"
        class="group/btn flex items-center justify-center w-10 h-10 rounded-xl transition-all duration-200 active:scale-95 shadow-md"
        [ngClass]="isExporting ? 'bg-rose-500 text-white animate-pulse' : 'bg-gradient-to-tr from-violet-600 to-indigo-500 text-white hover:scale-105 shadow-violet-200'">

        <svg *ngIf="!isExporting" class="w-5 h-5 text-white transition-transform group-hover/btn:rotate-6" aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linejoin="round" stroke-width="2"
                d="M16.444 18H19a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h2.556M17 11V5a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v6h10ZM7 15h10v4a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1v-4Z" />
        </svg>

        <div *ngIf="isExporting" class="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin">
        </div>
    </button>

    <div
        class="absolute top-full mt-4 left-1/2 -translate-x-1/2 px-2.5 py-1.5 text-[10px] font-bold text-white bg-slate-800 rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none whitespace-nowrap shadow-xl z-50">
        PRINT MAP
        <div class="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-slate-800 rotate-45"></div>
    </div>

    <div *ngIf="showMenu()"
        class="absolute top-full left-1/2 -translate-x-1/2 mt-4 bg-white/95 backdrop-blur-xl rounded-2xl shadow-[0_10px_40px_rgba(0,0,0,0.1)] border border-gray-100 flex flex-col overflow-hidden min-w-[180px] p-1.5 ring-1 ring-black/5 z-50">
        <div class="px-3 py-1.5 mb-1 text-[9px] uppercase tracking-wider font-bold text-slate-400">Select Format</div>

        <button (click)="export('png')"
            class="flex items-center justify-between px-3 py-2.5 rounded-xl hover:bg-violet-50 text-xs font-semibold text-slate-700 transition-all group/item">
            <div class="flex items-center gap-3">
                <span
                    class="flex items-center justify-center w-8 h-8 bg-violet-100 text-violet-600 rounded-lg shadow-sm group-hover/item:scale-110 transition-transform">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </span>
                <div class="flex flex-col items-start">
                    <span>Image</span>
                    <span class="text-[9px] text-slate-400 font-normal">High Res PNG</span>
                </div>
            </div>
        </button>

        <button (click)="export('pdf')"
            class="flex items-center justify-between px-3 py-2.5 rounded-xl hover:bg-rose-50 text-xs font-semibold text-slate-700 transition-all group/item">
            <div class="flex items-center gap-3">
                <span
                    class="flex items-center justify-center w-8 h-8 bg-rose-100 text-rose-600 rounded-lg shadow-sm group-hover/item:scale-110 transition-transform">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M9 9h1v1H9V9z" stroke-width="2" />
                    </svg>
                </span>
                <div class="flex flex-col items-start">
                    <span>Document</span>
                    <span class="text-[9px] text-slate-400 font-normal">Portable PDF</span>
                </div>
            </div>
        </button>
    </div>
</div>